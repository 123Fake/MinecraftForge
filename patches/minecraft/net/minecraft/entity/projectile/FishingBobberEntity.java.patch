--- a/net/minecraft/entity/projectile/FishingBobberEntity.java
+++ b/net/minecraft/entity/projectile/FishingBobberEntity.java
@@ -234,8 +234,8 @@
    private boolean func_234600_a_(PlayerEntity p_234600_1_) {
       ItemStack itemstack = p_234600_1_.func_184614_ca();
       ItemStack itemstack1 = p_234600_1_.func_184592_cb();
-      boolean flag = itemstack.func_77973_b() == Items.field_151112_aM;
-      boolean flag1 = itemstack1.func_77973_b() == Items.field_151112_aM;
+      boolean flag = itemstack.func_77973_b() instanceof net.minecraft.item.FishingRodItem;
+      boolean flag1 = itemstack1.func_77973_b() instanceof net.minecraft.item.FishingRodItem;
       if (!p_234600_1_.field_70128_L && p_234600_1_.func_70089_S() && (flag || flag1) && !(this.func_70068_e(p_234600_1_) > 1024.0D)) {
          return false;
       } else {
@@ -408,6 +408,7 @@
       PlayerEntity playerentity = this.func_234606_i_();
       if (!this.field_70170_p.field_72995_K && playerentity != null) {
          int i = 0;
+         net.minecraftforge.event.entity.player.ItemFishedEvent event = null;
          if (this.field_146043_c != null) {
             this.func_184527_k();
             CriteriaTriggers.field_204811_D.func_204820_a((ServerPlayerEntity)playerentity, p_146034_1_, this, Collections.emptyList());
@@ -415,8 +416,15 @@
             i = this.field_146043_c instanceof ItemEntity ? 3 : 5;
          } else if (this.field_146045_ax > 0) {
             LootContext.Builder lootcontext$builder = (new LootContext.Builder((ServerWorld)this.field_70170_p)).func_216015_a(LootParameters.field_216286_f, this.func_233580_cy_()).func_216015_a(LootParameters.field_216289_i, p_146034_1_).func_216015_a(LootParameters.field_216281_a, this).func_216023_a(this.field_70146_Z).func_186469_a((float)this.field_191518_aw + playerentity.func_184817_da());
+            lootcontext$builder.func_216015_a(LootParameters.field_216284_d, this.func_234616_v_()).func_216015_a(LootParameters.field_216281_a, this);
             LootTable loottable = this.field_70170_p.func_73046_m().func_200249_aQ().func_186521_a(LootTables.field_186387_al);
             List<ItemStack> list = loottable.func_216113_a(lootcontext$builder.func_216022_a(LootParameterSets.field_216262_c));
+            event = new net.minecraftforge.event.entity.player.ItemFishedEvent(list, this.field_70122_E ? 2 : 1, this);
+            net.minecraftforge.common.MinecraftForge.EVENT_BUS.post(event);
+            if (event.isCanceled()) {
+               this.func_70106_y();
+               return event.getRodDamage();
+            }
             CriteriaTriggers.field_204811_D.func_204820_a((ServerPlayerEntity)playerentity, p_146034_1_, this, list);
 
             for(ItemStack itemstack : list) {
@@ -441,7 +449,7 @@
          }
 
          this.func_70106_y();
-         return i;
+         return event == null ? i : event.getRodDamage();
       } else {
          return 0;
       }
@@ -468,8 +476,9 @@
       return false;
    }
 
-   public void func_70106_y() {
-      super.func_70106_y();
+   @Override
+   public void remove(boolean keepData) {
+      super.remove(keepData);
       PlayerEntity playerentity = this.func_234606_i_();
       if (playerentity != null) {
          playerentity.field_71104_cf = null;
